import"../chunks/Bzak7iHL.js";import{d as z,o as G,s as K}from"../chunks/Da2SbPGF.js";import{p as Q,s as x,a as X,f as y,c as h,b as p,d as b,g as Y,h as t,i as c,r as f,j as D,k as C,t as Z}from"../chunks/DzBT8ttv.js";import{i as L,b as tt}from"../chunks/CnlBk1NC.js";import{s as et}from"../chunks/c0lOkYTd.js";import"../chunks/BL_xpT-s.js";function at(m,i,a){c(i,(t(i)+1)%t(a).length)}function rt(m,i,a){c(i,(t(i)-1+t(a).length)%t(a).length)}function ot(m,i,a,o){const n=i(t(a)[t(o)].name);typeof window<"u"&&(window.location.href=`player/index.html?v=${encodeURIComponent(n)}`)}var it=y('<div class="p-8 text-center text-white">로딩 중...</div>'),st=y('<div class="p-8 text-center text-white">비디오 없음</div>'),nt=y('<div class="bg-black aspect-video w-full border border-white"><video controls autoplay playsinline="" class="w-full h-full object-contain"></video></div> <div class="mt-3 text-sm text-white"> </div>',3),ct=y('<div class="min-h-screen bg-black text-white border border-white"><div class="max-w-6xl mx-auto py-6 px-4 border border-white"><div class="flex items-center justify-between mb-4"><h1 class="text-xl">캡처 도구</h1> <div class="flex gap-2"><button class="px-3 py-2 bg-gray-800 border border-white text-white hover:bg-gray-700 transition">이전</button> <button class="px-3 py-2 bg-gray-800 border border-white text-white hover:bg-gray-700 transition">다음</button> <button class="px-3 py-2 bg-gray-600 border border-white text-white hover:bg-gray-500 transition">플레이어로 이동</button> <button class="px-3 py-2 bg-white border border-white text-black hover:bg-gray-200 transition">캡처</button></div></div> <!></div></div>');function ft(m,i){Q(i,!0);let a=x(X([])),o=x(0),n=x(void 0),P=x(!0);G(async()=>{if(await O(),typeof window<"u"){const r=new URLSearchParams(window.location.search).get("v");if(r!=null){const d=parseInt(r);if(!isNaN(d))c(o,Math.max(0,Math.min(d,t(a).length-1)),!0);else{const u=r.toLowerCase(),s=t(a).findIndex(l=>l.name.replace(/\.[^/.]+$/,"").toLowerCase()===u);s>=0&&c(o,s,!0)}}}c(P,!1)});async function O(){try{const e=await fetch("/api/videos");if(!e.ok)throw new Error("비디오 목록을 불러올 수 없습니다");const r=await e.json();c(a,Array.isArray(r)?r:[],!0)}catch(e){console.error(e),c(a,[],!0)}}function T(e){return e.replace(/\.[^/.]+$/,"")}async function $(){var s,l;if(!t(n))return;const e=document.createElement("canvas");e.width=t(n).videoWidth,e.height=t(n).videoHeight,e.getContext("2d").drawImage(t(n),0,0,e.width,e.height);const d=e.toDataURL("image/jpeg",.9),u=((l=(s=t(a)[t(o)])==null?void 0:s.name)==null?void 0:l.replace(/\.[^/.]+$/,""))||`capture_${Date.now()}`;try{if(!(await fetch("/api/gallery_thumbs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:u,dataUrl:d})})).ok)throw new Error("썸네일 저장 실패");alert("썸네일이 저장되었습니다.")}catch(g){console.error(g),alert("썸네일 저장에 실패했습니다.")}}var k=ct(),E=h(k),j=h(E),U=p(h(j),2),I=h(U);I.__click=[rt,o,a];var M=p(I,2);M.__click=[at,o,a];var R=p(M,2);R.__click=[ot,T,a,o];var B=p(R,2);B.__click=$,f(U),f(j);var F=p(j,2);{var H=e=>{var r=it();b(e,r)},J=e=>{var r=D(),d=C(r);{var u=s=>{var l=D(),g=C(l);{var V=v=>{var w=st();b(v,w)},W=v=>{var w=nt(),N=C(w),S=h(N);tt(S,_=>c(n,_),()=>t(n)),f(N);var A=p(N,2),q=h(A,!0);f(A),Z(()=>{var _;et(S,"src",t(a)[t(o)]?`/videos/${t(a)[t(o)].name}`:""),K(q,(_=t(a)[t(o)])==null?void 0:_.displayName)}),b(v,w)};L(g,v=>{t(a).length===0?v(V):v(W,!1)},!0)}b(s,l)};L(d,s=>{s(u,!1)},!0)}b(e,r)};L(F,e=>{t(P)?e(H):e(J,!1)})}f(E),f(k),b(m,k),Y()}z(["click"]);export{ft as component};
