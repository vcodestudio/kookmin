import"../chunks/Bzak7iHL.js";import{d as G,o as K,s as Q}from"../chunks/Da2SbPGF.js";import{p as X,s as x,a as Y,f as y,c as h,b,d as p,g as Z,h as t,i as c,r as f,j as B,k as C,t as tt}from"../chunks/DzBT8ttv.js";import{i as E,b as et}from"../chunks/CnlBk1NC.js";import{s as at}from"../chunks/c0lOkYTd.js";import"../chunks/BaTOazij.js";function rt(m,i,a){c(i,(t(i)+1)%t(a).length)}function ot(m,i,a){c(i,(t(i)-1+t(a).length)%t(a).length)}function it(m,i,a,o){const n=i(t(a)[t(o)].name);typeof window<"u"&&(window.location.href=`player/index.html?v=${encodeURIComponent(n)}`)}var st=y('<div class="p-8 text-center text-white">로딩 중...</div>'),nt=y('<div class="p-8 text-center text-white">비디오 없음</div>'),ct=y('<div class="bg-black aspect-video w-full border border-white"><video controls autoplay playsinline="" class="w-full h-full object-contain"></video></div> <div class="mt-3 text-sm text-white"> </div>',3),lt=y('<div class="min-h-screen bg-black text-white border border-white"><div class="max-w-6xl mx-auto py-6 px-4 border border-white"><div class="flex items-center justify-between mb-4"><h1 class="text-xl">캡처 도구</h1> <div class="flex gap-2"><button class="px-3 py-2 bg-gray-800 border border-white text-white hover:bg-gray-700 transition">이전</button> <button class="px-3 py-2 bg-gray-800 border border-white text-white hover:bg-gray-700 transition">다음</button> <button class="px-3 py-2 bg-gray-600 border border-white text-white hover:bg-gray-500 transition">플레이어로 이동</button> <button class="px-3 py-2 bg-white border border-white text-black hover:bg-gray-200 transition">캡처</button></div></div> <!></div></div>');function ut(m,i){X(i,!0);let a=x(Y([])),o=x(0),n=x(void 0),L=x(!0);K(async()=>{if(await D(),typeof window<"u"){const r=new URLSearchParams(window.location.search).get("v");if(r!=null){const d=parseInt(r);if(!isNaN(d))c(o,Math.max(0,Math.min(d,t(a).length-1)),!0);else{const u=r.toLowerCase(),s=t(a).findIndex(l=>l.name.replace(/\.[^/.]+$/,"").toLowerCase()===u);s>=0&&c(o,s,!0)}}}c(L,!1)});const k="/build";async function D(){try{const e=await fetch(`${k}/api/videos`);if(!e.ok)throw new Error("비디오 목록을 불러올 수 없습니다");const r=await e.json();c(a,Array.isArray(r)?r:[],!0)}catch(e){console.error(e),c(a,[],!0)}}function O(e){return e.replace(/\.[^/.]+$/,"")}async function T(){var s,l;if(!t(n))return;const e=document.createElement("canvas");e.width=t(n).videoWidth,e.height=t(n).videoHeight,e.getContext("2d").drawImage(t(n),0,0,e.width,e.height);const d=e.toDataURL("image/jpeg",.9),u=((l=(s=t(a)[t(o)])==null?void 0:s.name)==null?void 0:l.replace(/\.[^/.]+$/,""))||`capture_${Date.now()}`;try{if(!(await fetch(`${k}/api/gallery_thumbs`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:u,dataUrl:d})})).ok)throw new Error("썸네일 저장 실패");alert("썸네일이 저장되었습니다.")}catch(g){console.error(g),alert("썸네일 저장에 실패했습니다.")}}var j=lt(),$=h(j),N=h($),A=b(h(N),2),I=h(A);I.__click=[ot,o,a];var S=b(I,2);S.__click=[rt,o,a];var U=b(S,2);U.__click=[it,O,a,o];var F=b(U,2);F.__click=T,f(A),f(N);var H=b(N,2);{var J=e=>{var r=st();p(e,r)},V=e=>{var r=B(),d=C(r);{var u=s=>{var l=B(),g=C(l);{var W=v=>{var w=nt();p(v,w)},q=v=>{var w=ct(),P=C(w),M=h(P);et(M,_=>c(n,_),()=>t(n)),f(P);var R=b(P,2),z=h(R,!0);f(R),tt(()=>{var _;at(M,"src",t(a)[t(o)]?`${k}/videos/${t(a)[t(o)].name}`:""),Q(z,(_=t(a)[t(o)])==null?void 0:_.displayName)}),p(v,w)};E(g,v=>{t(a).length===0?v(W):v(q,!1)},!0)}p(s,l)};E(d,s=>{s(u,!1)},!0)}p(e,r)};E(H,e=>{t(L)?e(J):e(V,!1)})}f($),f(j),p(m,j),Z()}G(["click"]);export{ut as component};
